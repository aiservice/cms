/*!
 * Powered by uglifiyJS v2.6.1, Build by http://www.ossoft.cn
 * build time: Tue Jul 06 2021 11:38:56 GMT+0800 (China Standard Time)
*/
function submitForm(){vform.form()&&($("#pdName").val($("#priceType").find("option:selected").text()),ajax("/pay-item.html?method=submit",fromId,"POST",successHandle,!0,!0))}function submitInvitationCodeForm(){vform.form()&&($("#pdName").val($("#priceType").find("option:selected").text()),ajax("/pay-item.html?method=submitInvitationCode",fromId,"POST",successHandle,!0,!0))}function successHandle(e){if("1"==e.code){var a=JSON.stringify(jFrom.serializeFormJson());$.cookie("cookie_payitem"+id,a,{expires:7,path:"/"}),$.cookie("cookie_payurl"+id,e.datas,{expires:7,path:"/"}),location.href=e.datas}}function cPay(){var e=$.cookie("cookie_payurl"+id);e&&(location.href=e),$("#add_modal").modal("hide")}function loadWeChatTip(){var e=window.location.href;if(-1!==e.indexOf("alipay"))if(isWechat()){var a="";"undefined"!=typeof cdn&&(a=cdn);var r=a+"/styles/mall/img/wechat_android.png",i="\u4f7f\u7528\u6d4f\u89c8\u5668\u6253\u5f00";isIOS()&&(r=a+"/styles/mall/img/wechat_iphone.png",i="\u5728 Safari \u4e2d\u6253\u5f00");var o='<div id="wechat" style="margin: 0 auto; display: table; width: 85%; text-align: center; font-family: \'ciscosansthin\', \'Helvetica Neue\', Helvetica, Arial, sans-serif; font-size: 16px;"> <div> <p class="step1" style="margin: 32px 0;"><span>1. \u70b9\u51fb\u53f3\u4e0a\u89d2\u7684<strong>\u66f4\u591a</strong>\u83dc\u5355\u3002</span></p> </div> <div> <p class="step2" style="margin-bottom: 32px;"><span>2. \u70b9\u51fb<strong>'+i+'</strong>\u4ee5\u5b8c\u6210\u652f\u4ed8\u3002</span></p> <img src="'+r+'"/> </div> </div>';$("body").append(o),$("#main-container").hide()}else $("#main-container").show(),getOrder()}function getOrder(){ajax("/pay-item.html?method=alipayGateway",{tradeIndex:$("#tradeIndex").val()},"POST",orderHandle,!1,!0)}function orderHandle(e){if(1==e.code){var a=e.datas;$("#img").attr("src",a.img),$("#oid").val(a.oid),$("#fee").text(a.fee),startCheck(),isMobile()&&openAlipay(a.qrCode)}}function openAlipay(e){var a="alipays://platformapi/startapp?saId=10000007&qrcode=";if(a+=encodeURIComponent(e),navigator.userAgent.indexOf("Safari")>-1)window.location.href=a;else{var r=document.createElement("iframe");r.style.display="none",r.src=a,document.body.appendChild(r)}}function startCheck(){erphpOrder=setInterval(function(){$.ajax({type:"GET",data:"orderId="+$("#oid").val(),dataType:"json",url:"/pay-item.html?method=check",success:function(e){1==e.code?(clearInterval(erphpOrder),clearInterval(erphpTimer),popTip(e.msg),$("#container_data").hide(),$("#success_tip").show()):-1==e.code&&(clearInterval(erphpOrder),popTip(e.msg))},error:function(){}})},5e3),erphpTimer=setInterval(function(){wppayCountdown()},1e3)}function wppayCountdown(){Timer.innerHTML="\u652f\u4ed8\u5012\u8ba1\u65f6\uff1a<span>0"+m+"\u5206"+s+"\u79d2</span>",0==m&&0==s?(clearInterval(erphpOrder),clearInterval(erphpTimer),$(".qr-code").append('<div class="expired"></div>'),m=4,s=59):m>=0&&(s>0?s--:0==s&&(m--,s=59))}var vform,fromId="validation-form",jFrom=$("#"+fromId),id=$("#id").val();$(function(){vform=$("#"+fromId).validate({errorElement:"div",errorClass:"help-block",focusInvalid:!1,ignore:"",debug:!0,rules:{userName:{required:!0},phone:{required:!1,number:!0},email:{required:!0,email:!0},priceType:{required:!0},caseInfo:{required:!0}},messages:{userName:{required:"\u8bf7\u8f93\u5165\u59d3\u540d"},email:{required:"\u8bf7\u586b\u5199email",email:"\u8bf7\u8f93\u5165\u4e00\u4e2a\u6b63\u786e\u7684\u90ae\u7bb1"},phone:{required:"\u8bf7\u586b\u5199\u624b\u673a",email:"\u8bf7\u8f93\u5165\u6b63\u786e\u624b\u673a\u53f7"},priceType:{required:"\u8bf7\u9009\u62e9\u8d39\u7528\u7c7b\u578b"},caseInfo:{required:"\u8bf7\u9009\u62e9\u662f\u5426\u53c2\u52a0\u8bfe\u7a0b"}},highlight:function(e){$(e).closest(".form-group").removeClass("has-info").addClass("has-error")},success:function(e){$(e).closest(".form-group").removeClass("has-error"),$(e).remove()}});var e=$.cookie("cookie_payitem"+id);e&&jFrom.setForm(JSON.parse(e));var a=$.cookie("cookie_payurl"+id);a&&$("#add_modal").modal("show"),loadWeChatTip()});var Timer=document.getElementById("time"),m=5,s=0;